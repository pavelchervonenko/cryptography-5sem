# Курсовой проект по дисциплине «Основы криптографии»

Репозиторий содержит реализацию основных алгоритмов и протоколов классической криптографии на Java в рамках курсового проекта.  
При реализации **не используются готовые криптографические библиотеки**, реализующие сами алгоритмы шифрования: вся криптография написана вручную, допускается только применение стандартных типов языка (например, `BigInteger` для длинной арифметики).

---

## Навигация

- [1. Цели и задачи](#1-цели-и-задачи)
- [2. Реализованный функционал](#2-реализованный-функционал)
    - [2.1. Симметричные блочные шифры](#21-симметричные-блочные-шифры)
    - [2.2. Режимы шифрования](#22-режимы-шифрования)
    - [2.3. Режимы набивки (padding)](#23-режимы-набивки-padding)
    - [2.4. RSA и теоретико-числовые сервисы](#24-rsa-и-теоретико-числовые-сервисы)
    - [2.5. GF(2⁸) и Rijndael](#25-gf28-и-rijndael)
    - [2.6. Асинхронность и многопоточность](#26-асинхронность-и-многопоточность)
- [3. Структура проекта](#3-структура-проекта)
- [4. Требования](#4-требования)
- [5. Сборка и запуск](#5-сборка-и-запуск)

---

## 1. Цели и задачи

Цель проекта — закрепить теоретические знания по криптографии через самостоятельную реализацию базовых алгоритмов и режимов шифрования, а также сервисов для шифрования файлов (в том числе асинхронно и многопоточно).

В рамках курсовой реализованы три основных блока:

1. **Симметричные блочные шифры и режимы**: DES, TripleDES, DEAL; режимы шифрования и паддинги; шифрование файлов.
2. **RSA и числовые алгоритмы**: сервисы теории чисел, вероятностные тесты простоты, RSA, генерация ключей, атака Винера, шифрование файлов.
3. **Rijndael (AES) и арифметика в GF(2⁸)**: арифметика над двоичными полиномами, S-боксы, реализация Rijndael для нескольких размеров блоков и ключей, интеграция с режимами/паддингами и шифрование файлов.

---

## 2. Реализованный функционал

### 2.1. Симметричные блочные шифры

- **DES** (64-битный блок, 56-битный ключ):
    - Полная сеть Фейстеля, раундовая функция, расписание ключа.
    - Проверка по стандартному тест-вектору NIST.

- **TripleDES**:
    - Вариант на базе реализованного DES (EDE / EEE — в соответствии с заданием).
    - Совместимость с тестами через режимы.

- **DEAL**:
    - Реализация алгоритма DEAL (блочный шифр на основе DES).
    - Поддержка тех же режимов и паддингов, что и для DES/3DES.

### 2.2. Режимы шифрования

Для блочных шифров реализованы режимы (интерфейс `CipherMode`):

- **ECB**, **CBC**, **PCBC**
- **CFB**, **OFB**
- **CTR**, **Random Delta** (обобщённый счётчиковый режим)

Режимы используют абстракцию `BlockCipher` и могут работать с DES / 3DES / DEAL / Rijndael.

### 2.3. Режимы набивки (padding)

Реализован интерфейс `Padding`, а также следующие схемы набивки:

- `NoPadding`
- `ZerosPadding`
- `Pkcs7Padding`
- `AnsiX923Padding`
- `Iso10126Padding`

Паддинги применяются в связке с блочными режимами шифрования при работе с массивами байтов и файлами.

### 2.4. RSA и теоретико-числовые сервисы

- **Числовой сервис** (`NumberTheoryService`):
    - НОД (алгоритм Евклида);
    - расширенный алгоритм Евклида и соотношение Безу;
    - символ Лежандра и символ Якоби;
    - модульное возведение в степень.

- **Вероятностные тесты простоты**:
    - Тест Ферма;
    - Тест Соловея–Штрассена;
    - Тест Миллера–Рабина;
    - Общий абстрактный класс с шаблонным методом под одну итерацию.

- **RSA-сервис**:
    - Генерация простых чисел заданной битовой длины;
    - Генерация ключевой пары RSA с учётом защиты от атаки Винера;
    - Шифрование и расшифрование данных / файлов.

- **Атака Винера**:
    - Реализация атаки на открытый ключ RSA с «коротким» секретным показателем;
    - Выдача найденного `d`, φ(n) и последовательности подходящих дробей.

### 2.5. GF(2⁸) и Rijndael

- **Арифметика в GF(2⁸)**:
    - Сложение (XOR), умножение по модулю двоичного полинома;
    - Вычисление мультипликативного обратного элемента;
    - Проверка неприводимости полинома степени 8;
    - Перебор всех неприводимых двоичных полиномов степени 8 (ожидается 30 штук).

- **Rijndael (обобщённый AES)**:
    - Поддержка блоков и ключей 128 / 192 / 256 бит;
    - Адаптация параметров `Nb`, `Nk`, `Nr`;
    - Формирование S-бокса / обратного S-бокса через GF(2⁸) и аффинное преобразование;
    - Раундовая функция: SubBytes, ShiftRows, MixColumns, AddRoundKey;
    - Процедура расширения ключа (key schedule) c Rcon.

- **Интеграция с режимами и паддингами**:
    - Использование Rijndael через общий интерфейс `BlockCipher`;
    - Работа в режимах CBC, CTR и др. с паддингами PKCS7 и т.п.;
    - Шифрование и расшифрование файлов.

### 2.6. Асинхронность и многопоточность

- Сервис **`SymmetricCryptoService`**:
    - Синхронное и асинхронное шифрование/расшифрование массивов байтов и файлов;
    - Использование пула потоков (`ExecutorService`) и `Future`;
    - Возможность выполнять несколько операций шифрования параллельно.

- Сервис **`RsaFileCryptoService`**:
    - Блочное шифрование файлов RSA;
    - Асинхронные методы `encryptFileAsync(...)`, `decryptFileAsync(...)`.

---

## 3. Структура проекта

> Структура может немного отличаться в зависимости от текущего состояния репозитория.

```text
.
├── build.gradle.kts
├── settings.gradle.kts
├── README.md
└── src
    ├── main
    │   ├── java
    │   │   └── com
    │   │       └── pavel
    │   │           └── crypto
    │   │               ├── core/          # BlockCipher, CipherMode, Padding и др.
    │   │               ├── des/           # DES, TripleDES, DEAL
    │   │               ├── modes/         # ECB, CBC, CFB, OFB, CTR, RandomDelta...
    │   │               ├── padding/       # NoPadding, PKCS7, ANSI X.923, ISO 10126...
    │   │               ├── rsa/           # RSA-сервис, атака Винера, ключи
    │   │               ├── gf256/         # Арифметика GF(2^8)
    │   │               ├── rijndael/      # Реализация Rijndael
    │   │               ├── symmetric/     # SymmetricCryptoService и др.
    │   │               └── *.java         # Demo-классы (Main)
    │   └── resources
    └── test
        └── java       # При необходимости: юнит-тесты
```

---

## 4. Требования
- Java 17+ (или версия, указанная в build.gradle.kts);
- Gradle (Kotlin DSL);
- IntelliJ IDEA или любой другой IDE с поддержкой Gradle

---

## 5. Сборка и запуск

Сборка проекта:

```bash
./gradlew clean build

# Демонстрация DES / 3DES / DEAL
./gradlew :com.pavel.crypto.DesDemoMain.main

# Демонстрация RSA и тестов простоты
./gradlew :com.pavel.crypto.RsaMathDemoMain.main

# Демонстрация шифрования файлов RSA
./gradlew :com.pavel.crypto.RsaFileDemoMain.main

# GF(2^8) и неприводимые полиномы
./gradlew :com.pavel.crypto.Gf256DemoMain.main

# Тестовый вектор AES-128 и Rijndael
./gradlew :com.pavel.crypto.RijndaelDemoMain.main

# Полный self-test Rijndael + режимы/паддинги/файлы
./gradlew :com.pavel.crypto.RijndaelAllDemoMain.main
```